# 规则完善

## 时间限制规则

### 1. 上班时间限制
- **最早上班时间**：8:00
- **弹性时间区间**：8:00 - 9:30
- **规则**：如果输入的上班时间早于 8:00，系统自动调整为 8:00

**示例**：
```
输入 7:50  → 自动调整为 8:00
输入 8:00  → 保持 8:00
输入 8:30  → 保持 8:30
输入 9:00  → 保持 9:00
```

### 2. 下班时间限制
- **最早下班时间**：18:00
- **弹性时间区间**：18:00 - 19:30
- **规则**：
  - 下班时间不能早于 18:00
  - 下班时间必须晚于上班时间

**示例**：
```
输入 17:50  → 提示错误，不允许设置
输入 18:00  → 保持 18:00（最早下班时间）
输入 19:00  → 保持 19:00
```

### 3. 验证提示
- 上班时间早于 8:00：显示提示 "🕘 上班时间已调整为 8:00（不能早于8点）"
- 下班时间早于 18:00：显示警告 "⚠️ 下班时间不能早于 18:00"
- 下班时间早于或等于上班时间：显示警告 "⚠️ 下班时间必须晚于上班时间"

## 计算规则补充

### 有效工时计算
1. **上班时间调整**：如果早于 8:00，按 8:00 计算
2. **午休扣除**：12:00 - 14:00（2 小时）
3. **加班扣除**：已申请的加班时长从当天工时中扣除

### 日期范围筛选功能

**功能说明**：
- 用户可以通过工具栏的日期范围选择器选择统计范围（几月几号到几月几号）
- 日期筛选器为可选功能，不选择时默认计算所有记录
- 选择日期范围后，系统仅统计该日期范围内的打卡记录和工时

**使用场景**：
- 只统计某一周的工时（如：2月9日 - 2月14日）
- 只统计某个时间段的工时（如：上半月、下半月）
- 灵活查看任意时间范围的工时完成情况

**实现逻辑**：
- 筛选只影响统计计算（已工作天数、总有效工时、还需工时、今天下班时间）
- 不影响打卡记录的显示（右侧列表始终显示所有记录）
- 工作天数自动根据筛选结果计算（筛选范围内有记录的天数）

### 假期同步功能

**功能说明**：
- 工具栏新增"同步假期"按钮，可从在线 API 获取最新的法定节假日数据
- 点击同步按钮后，系统会从互联网获取当年的假期安排
- 日历中会以淡绿色标记法定节假日，以浅绿色标记周末
- 每月只能同步一次，点击后按钮显示"已同步"并禁用

**同步规则**：
- 首次打开应用时，自动从缓存加载假期数据
- 如果本月未同步过，可点击"同步假期"按钮进行同步
- 同步成功后，假期数据会保存到浏览器本地缓存
- 下个月内再次点击会提示"本月已同步过假期数据，每月只能同步一次"
- 跨月后可重新同步（例如：从2月进入3月时可以再次同步）

**假期数据来源**：
- 使用 timor.tech 的免费 API 获取中国法定节假日
- 包括元旦、春节、清明、劳动、端午、中秋、国庆等所有法定节假日
- 自动识别周六、周日为周末，并标记显示

### UI 提示
在主界面下方显示提示：
```
💡 点击输入框可选择时间，或直接手动输入
💡 可通过日期筛选器选择统计范围
💡 点击"同步假期"按钮可获取最新的法定节假日数据
```
